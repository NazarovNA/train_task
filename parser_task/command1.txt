import time
from budgetes.models import Budget
from parser_task.parser import ParseRequest

table_correspondences = {'code': 'code',
                            'name': 'name',
                            'parentcode': 'parentcode',
                            'enddate': 'enddate',
                            'startdate': 'startdate',
                            'status': 'status',
                            'budgtypecode': 'budgettype'}

url = "http://budget.gov.ru/epbs/registry/7710568760-BUDGETS/data?pageSize=1000&filterstatus=ACTIVE&pageNum=1"
model = Budget
code_field = 'code'
foreign_key_fields = {'parentcode': [Budget, 'code', 'parentcode']}

a = ParseRequest(table_correspondences=table_correspondences, url=url, model=model, code_field=code_field, foreign_key_fields=foreign_key_fields)
start_time = time.time()
a.download_external_api()
print("--- %s seconds ---" % (time.time() - start_time))